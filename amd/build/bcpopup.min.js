!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";t.fn.bcPopUp=function(e,o){var a=!1;if("close"===e){if(t(l=this).hasClass("bc-hidden"))t(l).hide();else{var i=this.attr("bc-layer");t(l).addClass("bc-hidden"),this.animate({top:"-50%"},500,function(){0==t(l).attr("bc-element")?t(this).remove():t(this).hide()}),t('.bc-overlay[bc-layer="'+i+'"]').fadeOut(500,function(){0==t(l).attr("bc-element")?t(this).remove():t(this).hide()})}return!1}if("destroy"==e){var l=this;i=this.attr("bc-layer");return t(this).remove(),t("#bc-overlay-"+i).remove(),!1}var d=t.extend({title:"",content:"",open:function(){},afterLoad:function(){},url:"",urlType:"html",buttons:{},follow:[{x:!0,y:!0}],allowMultiple:!0,showHeader:!0,showFooter:!0,showCloseButton:!0,showOverlay:!0,clickOverlayToClose:!0,draggable:!0,expandable:!0,overrideWidth:!1,forceRefresh:!0,appendTo:"body"},e);d.title=t.trim(d.title);var c=2999,s=3e3,r=1,n=t(window).scrollLeft()+150+"px",h=t(window).scrollTop()+50+"px",b=new Array,m=(t(window).height(),t(window).width(),!0===d.allowMultiple?1:0);if(!0===d.allowMultiple){var f=t(".bc-modal:last");if(t(f).length>0&&(c=parseInt(t(f).css("z-index"))+1,s=parseInt(t(f).css("z-index"))+2,r=t(".bc-modal").length+1,t(".bc-modal:not(.bc-hidden)").length>0)){var p=t(".bc-modal:not(.bc-hidden):last"),u=100*Math.random()-25,w=100*Math.random()-25;n=(parseInt(t(p).css("left"))+u).toFixed()+"px",h=(parseInt(t(p).css("top"))+w).toFixed()+"px"}}else!0===d.forceRefresh&&(t(".bc-modal").remove(),t(".bc-overlay").remove());if(t(this).hasClass("bc-modal")){var v=".bc-modal-"+t(this).attr("bc-layer"),y=t("#bc-overlay-"+t(this).attr("bc-layer"));n="150px",h=t(window).scrollTop()+50+"px"}else{y=void 0;if(void 0!==t(this).prop("tagName")){""===d.title&&(void 0!==t(this).attr("title")?d.title=t(this).attr("title"):d.title=""),""===d.content&&(d.content=t(this).html()),t(this).addClass("bc-modal").addClass("bc-modal-"+r),t(this).css("left",n).css("z-index",s),t(this).attr("bc-layer",r),t(this).attr("bc-static",m),!1!==d.overrideWidth&&(t(this).css("width",d.overrideWidth),t(this).css("max-width",d.overrideWidth));var x=d.content,g=""}else{var C="left:"+n+";z-index:"+s+";";!1!==d.overrideWidth&&(C+="width:"+d.overrideWidth+";max-width:"+d.overrideWidth+";");g="<div id='' class='bc-modal bc-modal-"+r+"' style='"+C+"' bc-layer='"+r+"' bc-element='0' bc-static='"+m+"'>",x=d.content}if(g+="<span class='bc-close'>X</span>",(d.title.length>0||!0===d.showHeader)&&(g+="<div class='bc-modal-header'><h1>"+d.title+"</h1></div>"),g+="<div class='bc-modal-body'>",d.url.length>0?"html"===d.urlType?g+="<iframe class='bc-iframe' scrolling='no' frameborder='0' src='"+d.url+"'></iframe>":"image"===d.urlType?g+="<img src='"+d.url+"' />":"ajax"===d.urlType&&(g+="loading..."):g+=x,g+="</div>",!0===d.showFooter&&(g+="<div class='bc-modal-footer'></div>"),!0===d.showFooter){var T=0;for(var k in d.buttons){var L;b[++T]=d.buttons[k],(L=t("<div>"+g+"</div>")).find(".bc-modal-footer").append("<button class='bc-button' bc-button-number='"+T+"'>"+k+"</button>"),g=L.html()}if(!0===d.showCloseButton)(L=t("<div>"+g+"</div>")).find(".bc-modal-footer").append("<button class='bc-close'>Close</button>"),g=L.html()}void 0!==t(this).prop("tagName")?t(this).html(g):(g+="</div>",t("body").append(g));v=".bc-modal-"+r}if("function"==typeof d.open&&d.open(),"ajax"===d.urlType&&t(v+" .bc-modal-body").load(d.url,{cache:!1},function(){"function"==typeof d.afterLoad&&d.afterLoad()}),function(t,e,o){t.removeClass("bc-hidden"),t.show(),t.appendTo(o),t.animate({top:parseInt(e)},500,"easeOutBack")}(t(v),h,d.appendTo),"function"==typeof d.afterLoad&&"ajax"!==d.urlType&&d.afterLoad(),function(e,o,a){!0===d.showOverlay&&(void 0!==a?a.fadeIn(500):(t("body").append("<div id='bc-overlay-"+e+"' class='bc-overlay' style='z-index:"+o+";' bc-layer='"+e+"'></div>"),t("#bc-overlay-"+e).fadeIn(500)))}(r,c,y),1===t(".bc-modal").length&&function(e){var o=t(e).width(),a=(t(window).width()-o)/2;t(e).css("left",a+"px")}(v),!0===d.draggable&&(t(v).draggable({handle:".bc-modal-header",containment:"document"}),t(v+" .bc-modal-header").css("cursor","move")),!1===d.allowMultiple){t(window).scroll(function(){t(v).offset();var e=t(v).width(),o=(t(window).width()-e)/2;t(v).hasClass("ui-draggable-dragging")||t(v).hasClass("bc-hidden")||1==t(v).attr("bc-static")||(!0===d.follow[0].y&&!0===d.follow[0].x?t(v).stop().animate({top:t(window).scrollTop()+50,left:t(window).scrollLeft()+o}):!0===d.follow[0].y?t(v).stop().animate({left:t(window).scrollLeft()+o}):!0===d.follow[0].x&&t(v).stop().animate({left:t(window).scrollLeft()+o}))})}return t(".bc-close").unbind("click"),t(".bc-close").bind("click",function(e){t(t(this).parents(".bc-modal")[0]).bcPopUp("close"),e.preventDefault()}),t(v+" button.bc-button").each(function(){var e=t(this).attr("bc-button-number"),o=b[e];void 0!==o&&(t(this).unbind("click"),t(this).bind("click",o))}),!0===d.expandable&&(t(v+" .bc-modal-header").unbind("dblclick"),t(v+" .bc-modal-header").dblclick(function(){if(t(v).hasClass("bc-expanded"))t(v).removeClass("bc-expanded"),t(v).css("top",t(v).attr("bc-old-top")),t(v).css("left",t(v).attr("bc-old-left")),t(v).css("max-width",t(v).attr("bc-old-max-width")),t(v).css("width",t(v).attr("bc-old-width")),t(v).css("max-height",t(v).attr("bc-old-max-height")),t(v).css("height",t(v).attr("bc-old-height")),t(v+" .bc-modal-body").css("max-height",t(v+" .bc-modal-body").attr("bc-old-max-height")),t(v+" .bc-modal-body").css("height",t(v+" .bc-modal-body").attr("bc-old-height"));else{var e=t(v).css("left"),o=t(v).css("top"),a=t(v).width(),i=t(v).css("max-width"),l=a+(t(window).width()-a-20),d=t(v).height(),c=t(v).css("max-width"),s=d+(t(window).height()-d-20),r=t(v+" .bc-modal-body").height(),n=t(v+" .bc-modal-body").css("max-height"),h=s-100;t(v).css("max-width",l).css("width",l).css("max-height",s).css("height",s).css("left",5).css("top",5),t(v).addClass("bc-expanded"),t(v).attr("bc-old-width",a).attr("bc-old-height",d).attr("bc-old-max-width",i).attr("bc-old-max-height",c).attr("bc-old-left",e).attr("bc-old-top",o),t(v+" .bc-modal-body").css("height",h).css("max-height",h),t(v+" .bc-modal-body").attr("bc-old-height",r).attr("bc-old-max-height",n)}})),!0===d.showOverlay&&!0===d.clickOverlayToClose&&(t("#bc-overlay-"+r).unbind("click"),t("#bc-overlay-"+r).bind("click",function(){t(v).bcPopUp("close")})),!1===a&&(a=t(document).keyup(function(e){27===e.which&&t(".bc-modal").each(function(){t(this).bcPopUp("close",{animate:!1})})})),this}});