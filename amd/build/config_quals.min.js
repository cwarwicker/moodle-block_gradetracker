define(["jquery","jqueryui"],function(a,b){var c={};c.init=function(){c.bindings()},c.bindings=function(){a("#gt_filter_units_name").unbind("keypress"),a("#gt_filter_units_name").bind("keypress",function(a){13===a.keyCode&&(c.filterUnits(),a.preventDefault())}),a("#gt_filter_courses_name").unbind("keypress"),a("#gt_filter_courses_name").bind("keypress",function(a){13===a.keyCode&&(c.filterCourses(),a.preventDefault())}),a("#qual_units").off("change"),a("#qual_units").on("change",function(){var b=a(this).val(),c=null!==b?b.length:0;1==c?(a("#gt_qual_units_edit_unit_btn").removeAttr("disabled"),a("#gt_qual_units_edit_unit_btn").attr("href","config.php?view=units&section=edit&id="+b)):(a("#gt_qual_units_edit_unit_btn").attr("disabled",!0),a("#gt_qual_units_edit_unit_btn").removeAttr("href"))}),a("#qual_courses").off("change"),a("#qual_courses").on("change",function(){var b=a(this).val(),c=null!==b?b.length:0;1==c?(a("#gt_qual_units_edit_course_btn").removeAttr("disabled"),a("#gt_qual_units_edit_course_btn").attr("href","config.php?view=course&section=quals&id="+b)):(a("#gt_qual_units_edit_course_btn").attr("disabled",!0),a("#gt_qual_units_edit_course_btn").removeAttr("href"))}),a(".gt_filter_units").unbind("click"),a(".gt_filter_units").bind("click",function(a){c.filterUnits(),a.preventDefault()}),a("#gt_add_units_to_qual_select").unbind("click"),a("#gt_add_units_to_qual_select").bind("click",function(b){var c=a("#gt_filter_units option:selected");a.each(c,function(){var b=a(this).val();a(this).prop("selected",!1),a(this).attr("id","qual_unit_opt_"+b),a("#qual_units").append(a(this)),a("#gt_qual_form").append("<input type='hidden' id='hidden_qual_unit_"+b+"' name='qual_units[]' value='"+b+"' />")}),b.preventDefault()}),a("#gt_remove_unit_from_qual_select").unbind("click"),a("#gt_remove_unit_from_qual_select").bind("click",function(b){var c=a("#qual_units option:selected");a.each(c,function(){var b=a(this).val();a(this).prop("selected",!1),a("#gt_filter_units").append(a(this)),a("#hidden_qual_unit_"+b).remove()}),b.preventDefault()}),a("#gt_add_courses_to_qual_select").unbind("click"),a("#gt_add_courses_to_qual_select").bind("click",function(b){var c=a("#gt_filter_courses option:selected");a.each(c,function(){var b=a(this).val();b>0&&(a(this).prop("selected",!1),a(this).attr("id","qual_course_opt_"+b),a("#qual_courses").append(a(this)),a("#gt_qual_form").append("<input type='hidden' id='hidden_qual_course_"+b+"' name='qual_courses[]' value='"+b+"' />"))}),b.preventDefault()}),a("#gt_remove_courses_from_qual_select").unbind("click"),a("#gt_remove_courses_from_qual_select").bind("click",function(b){var c=a("#qual_courses option:selected");a.each(c,function(){var b=a(this).val();a(this).prop("selected",!1),a("#gt_filter_courses").append(a(this)),a("#hidden_qual_course_"+b).remove()}),b.preventDefault()}),a(".gt_filter_courses").unbind("click"),a(".gt_filter_courses").bind("click",function(a){c.filterCourses(),a.preventDefault()}),a(".gt_load_build_defaults").unbind("change"),a(".gt_load_build_defaults").bind("change",function(b){if(0==a("#qual_id").length){a("#gt_build_loading").show(),a('.gt_qual_element[type!="checkbox"]').val(""),a('.gt_qual_element[type="checkbox"]').prop("checked",!1);var c=a(this).val(),d={buildID:c};GT.ajax(M.cfg.wwwroot+"/blocks/gradetracker/ajax/get.php",{action:"get_build_defaults",params:d},function(b){defaults=a.parseJSON(b),a.each(defaults,function(b,c){a("#gt_el_"+b).val(c),"checkbox"==a("#gt_el_"+b).prop("type")&&1==c&&a("#gt_el_"+b).prop("checked",!0)}),a("#gt_build_loading").hide()})}b.preventDefault()}),GT.bind()},c.filterUnits=function(){var b=a("#gt_filter_units_structure").val(),c=a("#gt_filter_units_level").val(),d=a("#gt_filter_units_name").val(),e={structureID:b,levelID:c,name:d};a("#gt_filter_units_loading").show(),a("#gt_filter_units").html(""),GT.ajax(M.cfg.wwwroot+"/blocks/gradetracker/ajax/get.php",{action:"get_filtered_units",params:e},function(b){var c=a.parseJSON(b);a.each(c,function(b,c){if(0==a("#unit_opt_"+c.id).length&&0==a("#qual_unit_opt_"+c.id).length){var d="<option id='unit_opt_"+c.id+"' value='"+c.id+"' title='"+c.title+"'>"+c.name+"</option>";a("#gt_filter_units").append(d)}}),a("#gt_filter_units_loading").hide()})},c.filterCourses=function(){var b=a.trim(a("#gt_filter_courses_name").val()),c=a("#gt_filter_courses_category").val(),d={catID:c,name:b};""===b&&""===c||(a("#gt_filter_courses_loading").show(),a("#gt_filter_courses").html(""),GT.ajax(M.cfg.wwwroot+"/blocks/gradetracker/ajax/get.php",{action:"get_filtered_courses",params:d},function(b){var c=a.parseJSON(b);a.each(c,function(b,c){if(0==a("#course_opt_"+c.id).length&&0==a("#qual_course_opt_"+c.id).length){var d="<option id='course_opt_"+c.id+"' value='"+c.id+"'>"+c.name+"</option>";a("#gt_filter_courses").append(d)}}),c.length>=searchLimit&&a("#gt_filter_courses").append("<option>"+M.util.get_string("toomanytoshow","block_gradetracker")+"</option>"),a("#gt_filter_courses_loading").hide()}))};var d={};return d.log=function(a){console.log("[GT] "+(new Date).toTimeString().split(" ")[0]+": "+a)},d.init=function(){c.init(),d.log("Loaded config_quals.js")},d});