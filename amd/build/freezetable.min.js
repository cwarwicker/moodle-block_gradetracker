!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof exports?module.exports=i(require("jquery")):i(jQuery)}(function(i){"use strict";var e=function(e,t){return this.$tableWrapper=i(e).first(),this.options=t||{},this.namespace=this.options.namespace||"freeze-table",this.callback,this.scrollBarHeight,this.shadow,this.fastMode,this.backgroundColor,this.scrollable,this.$table=this.$tableWrapper.children("table"),this.$container=void 0!==this.options.container&&this.options.container&&i(this.options.container).length?i(this.options.container):i(window),this.$headTableWrap,this.$columnTableWrap,this.$columnHeadTableWrap,this.$scrollBarWrap,this.fixedNavbarHeight,this.isWindowScrollX=!1,this.headWrapClass="clone-head-table-wrap",this.columnWrapClass="clone-column-table-wrap",this.columnHeadWrapClass="clone-column-head-table-wrap",this.scrollBarWrapClass="clone-scroll-bar-wrap",this.init(),this};e.prototype.init=function(){if(!this.$table.length)throw"The element must contain a table dom";if("update"===this.options)this.destroy(),this.options=this.$tableWrapper.data("freeze-table-data");else{if("resize"===this.options)return this.options=this.$tableWrapper.data("freeze-table-data"),this.namespace=this.options.namespace||this.namespace,void this.resize();if("destroy"===this.options)return void this.destroy();this.$tableWrapper.data("freeze-table-data",this.options)}var e=this.options,t=void 0===e.freezeHead||e.freezeHead,s=void 0===e.freezeColumn||e.freezeColumn,a=void 0===e.freezeColumnHead||e.freezeColumnHead,l=void 0!==e.scrollBar&&e.scrollBar,o=e.fixedNavbar||".navbar-fixed-top",r=e.callback||null;this.namespace=this.options.namespace||this.namespace,this.scrollBarHeight=i.isNumeric(e.scrollBarHeight)?e.scrollBarHeight:window.innerWidth-document.documentElement.clientWidth,this.shadow=void 0!==e.shadow&&e.shadow,this.fastMode=void 0!==e.fastMode&&e.fastMode,this.backgroundColor=void 0!==e.backgroundColor?e.backgroundColor:"white",this.scrollable=void 0!==e.scrollable&&e.scrollable,this.fixedNavbarHeight=o&&i(o).outerHeight()||0,this.isInit()&&this.destroy(),this.scrollable||this.$tableWrapper.css("height","100%").css("min-height","100%").css("max-height","100%"),t&&this.buildHeadTable(),s&&(this.buildColumnTable(),this.$tableWrapper.css("overflow-x","scroll")),a&&t&&s&&this.buildColumnHeadTable(),l&&this.buildScrollBar();var n=function(){this.$container.scrollLeft()>0?(this.isWindowScrollX=!0,this.$headTableWrap&&this.$headTableWrap.css("visibility","hidden"),this.$columnTableWrap&&this.$columnTableWrap.css("visibility","hidden"),this.$columnHeadTableWrap&&this.$columnHeadTableWrap.css("visibility","hidden"),this.$scrollBarWrap&&this.$scrollBarWrap.css("visibility","hidden")):this.isWindowScrollX=!1}.bind(this);this.$container.on("scroll."+this.namespace,function(){n()}),this.resize(),"function"==typeof r&&r()},e.prototype.buildHeadTable=function(){var e=this,t=this.clone(this.$table);if(this.fastMode)t=this.simplifyHead(t);var s=this.options.headWrapStyles||null;if(this.$headTableWrap=i('<div class="'+this.headWrapClass+'"></div>').append(t).css("position","fixed").css("overflow","hidden").css("visibility","hidden").css("top",0+this.fixedNavbarHeight).css("z-index",2),this.shadow&&this.$headTableWrap.css("box-shadow","0px 6px 10px -5px rgba(159, 159, 160, 0.8)"),s&&"object"==typeof s&&i.each(s,function(i,t){e.$headTableWrap.css(i,t)}),this.$tableWrapper.append(this.$headTableWrap),this.$tableWrapper.on("scroll."+this.namespace,function(){e.$headTableWrap.scrollLeft(i(this).scrollLeft())}),this.scrollable){var a=function(i,e){var t=e.$tableWrapper.offset().top;e.$tableWrapper.scrollTop()>0&&t>e.fixedNavbarHeight?(e.$headTableWrap.offset({top:t}),e.$headTableWrap.css("visibility","visible")):e.$headTableWrap.css("visibility","hidden")};this.$tableWrapper.on("scroll."+this.namespace,function(){a(window,e)}),this.$container.on("scroll."+this.namespace,function(){a(window,e)})}else i.isWindow(e.$container.get(0))?this.$container.on("scroll."+this.namespace,function(){var i=e.$container.scrollTop()+e.fixedNavbarHeight,t=e.$table.offset().top-1;t-1<=i&&t+e.$table.outerHeight()-1>=i?e.$headTableWrap.css("visibility","visible"):e.$headTableWrap.css("visibility","hidden")}):this.$container.on("scroll."+this.namespace,function(){var t=i(window).scrollTop(),s=e.$table.offset().top-1;s<=t&&s+e.$table.outerHeight()-1>=t?(e.$headTableWrap.offset({top:t}),e.$headTableWrap.css("visibility","visible")):e.$headTableWrap.css("visibility","hidden")});this.$container.on("resize."+this.namespace,function(){var i=e.scrollable?e.$tableWrapper.width()-e.scrollBarHeight:e.$tableWrapper.width();i=i>0?i:e.$tableWrapper.width(),e.$headTableWrap.css("width",i),e.$headTableWrap.css("height",e.$table.find("thead").outerHeight())})},e.prototype.buildColumnTable=function(){var e=this,t=this.options.columnWrapStyles||null,s=this.options.columnNum||1,a=void 0!==this.options.columnKeep&&this.options.columnKeep,l=this.shadow?0:1,o=void 0!==this.options.columnBorderWidth?this.options.columnBorderWidth:l,r=this.clone(this.$table);if(this.$columnTableWrap=i('<div class="'+this.columnWrapClass+'"></div>').append(r).css("position","fixed").css("overflow","hidden").css("visibility","hidden").css("z-index",1),this.shadow&&this.$columnTableWrap.css("box-shadow","6px 0px 10px -5px rgba(159, 159, 160, 0.8)"),t&&"object"==typeof t&&i.each(t,function(i,t){e.$columnTableWrap.css(i,t)}),this.scrollable){var n=this.$tableWrapper.height()-this.scrollBarHeight;n=n>0?n:this.$tableWrapper.height(),this.$columnTableWrap.height(n)}this.$tableWrapper.append(this.$columnTableWrap);var h=function(){e.$columnTableWrap.offset({top:e.$tableWrapper.offset().top})};a?this.$columnTableWrap.css("visibility","visible"):e.scrollable?this.$tableWrapper.on("scroll."+this.namespace,function(){i(this).scrollLeft()>0?(e.$columnTableWrap.scrollTop(e.$tableWrapper.scrollTop()),e.$columnTableWrap.css("visibility","visible")):e.$columnTableWrap.css("visibility","hidden")}):this.$tableWrapper.on("scroll."+this.namespace,function(){e.isWindowScrollX||(i(this).scrollLeft()>0?e.$columnTableWrap.css("visibility","visible"):e.$columnTableWrap.css("visibility","hidden"))}),this.$container.on("resize."+this.namespace,function(){r.width(e.$table.width());for(var i=0+o,t=1;t<=s;t++){var a=e.$table.find("th:nth-child("+t+")").outerWidth();i+=a>0?a:e.$table.find("td:nth-child("+t+")").outerWidth()}e.$columnTableWrap.width(i),h()}),this.$container.on("scroll."+this.namespace,function(){h()})},e.prototype.buildColumnHeadTable=function(){var e=this;this.$columnHeadTableWrap=this.clone(this.$headTableWrap),this.fastMode&&(this.$columnHeadTableWrap=this.simplifyHead(this.$columnHeadTableWrap));var t=this.options.columnHeadWrapStyles||null;if(this.$columnHeadTableWrap.removeClass(this.namespace).addClass(this.columnHeadWrapClass).css("z-index",3),this.shadow&&this.$columnHeadTableWrap.css("box-shadow","none"),t&&"object"==typeof t&&i.each(t,function(i,e){this.$columnHeadTableWrap.css(i,e)}),this.$tableWrapper.append(this.$columnHeadTableWrap),this.scrollable){var s=function(){var i=e.$tableWrapper.offset().top;e.$tableWrapper.scrollTop()>0&&i>e.fixedNavbarHeight?(e.$columnHeadTableWrap.offset({top:i}),e.$columnHeadTableWrap.css("visibility","visible")):e.$columnHeadTableWrap.css("visibility","hidden")};i(this.$tableWrapper).on("scroll."+this.namespace,function(){s()})}else if(i.isWindow(this.$container.get(0)))s=function(){var i=e.$container.scrollTop()+e.fixedNavbarHeight,t=e.$table.offset().top-1;t-1<=i&&t+e.$table.outerHeight()-1>=i&&e.$tableWrapper.scrollLeft()>0?e.$columnHeadTableWrap.css("visibility","visible"):e.$columnHeadTableWrap.css("visibility","hidden")};else s=function(){var t=i(window).scrollTop(),s=e.$table.offset().top-1;s<=t&&s+e.$table.outerHeight()-1>=t&&e.$tableWrapper.scrollLeft()>0?(e.$columnHeadTableWrap.offset({top:t}),e.$columnHeadTableWrap.css("visibility","visible")):e.$columnHeadTableWrap.css("visibility","hidden")};this.$container.on("scroll."+this.namespace,function(){s()}),this.$tableWrapper.on("scroll."+this.namespace,function(){e.isWindowScrollX||s()}),this.$container.on("resize."+this.namespace,function(){e.$columnHeadTableWrap.find("> table").css("width",e.$table.width()),e.$columnHeadTableWrap.css("width",e.$columnTableWrap.width()),e.$columnHeadTableWrap.css("height",e.$table.find("thead").outerHeight())})},e.prototype.buildScrollBar=function(){var e=this,t=this.$table.find("thead").outerHeight(),s=i('<div class="'+this.scrollBarWrapClass+'"></div>').css("width",this.$table.width()).css("height",1);this.$scrollBarWrap=i('<div class="'+this.scrollBarWrapClass+'"></div>').css("position","fixed").css("overflow-x","scroll").css("visibility","hidden").css("bottom",0).css("z-index",2).css("width",this.$tableWrapper.width()).css("height",this.scrollBarHeight),this.$scrollBarWrap.append(s),this.$tableWrapper.append(this.$scrollBarWrap),this.$scrollBarWrap.on("scroll."+this.namespace,function(){e.$tableWrapper.scrollLeft(i(this).scrollLeft())}),this.$tableWrapper.on("scroll."+this.namespace,function(){e.$scrollBarWrap.scrollLeft(i(this).scrollLeft())}),this.$container.on("scroll."+this.namespace,function(){var i=e.$container.scrollTop()+e.$container.height()-t+e.fixedNavbarHeight;e.$table.offset().top-1<=i&&e.$table.offset().top+e.$table.outerHeight()-1>=i?e.$scrollBarWrap.css("visibility","visible"):e.$scrollBarWrap.css("visibility","hidden")}),this.$container.on("resize."+this.namespace,function(){s.css("width",e.$table.width()),e.$scrollBarWrap.css("width",e.$tableWrapper.width())})},e.prototype.clone=function(e){var t=i(e).clone().removeAttr("id");return this.backgroundColor&&t.css("background-color",this.backgroundColor),t},e.prototype.simplifyHead=function(e){var t=this,s=i(e);return s.find("> tr, > tbody > tr, tfoot > tr").not(":first").remove(),i.each(s.find("> thead > tr:nth-child(1) >"),function(e,s){var a=t.$table.find("> thead > tr:nth-child(1) > :nth-child("+parseInt(e+1)+")").outerWidth();i(this).css("width",a)}),s},e.prototype.isInit=function(){return!!this.$tableWrapper.find("."+this.headWrapClass).length||(!!this.$tableWrapper.find("."+this.columnWrapClass).length||(!!this.$tableWrapper.find("."+this.columnHeadWrapClass).length||!!this.$tableWrapper.find("."+this.scrollBarWrapClass).length))},e.prototype.unbind=function(){this.$container.off("resize."+this.namespace),this.$container.off("scroll."+this.namespace),this.$tableWrapper.off("scroll."+this.namespace)},e.prototype.destroy=function(){this.unbind(),this.$tableWrapper.find("."+this.headWrapClass).remove(),this.$tableWrapper.find("."+this.columnWrapClass).remove(),this.$tableWrapper.find("."+this.columnHeadWrapClass).remove(),this.$tableWrapper.find("."+this.scrollBarWrapClass).remove()},e.prototype.resize=function(){return this.$container.trigger("resize."+this.namespace),this.$container.trigger("scroll."+this.namespace),this.$tableWrapper.trigger("scroll."+this.namespace),!0},e.prototype.update=function(){return this.options="update",this.init(),this},window.FreezeTable=e,i.fn.freezeTable=function(i){if(1===this.length)return new e(this,i);if(this.length>1){var t=[];return this.each(function(){t.push(new e(this,i))}),t}return!1}});