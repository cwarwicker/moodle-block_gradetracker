<?php if(!defined('BCGT')) exit; ?>

<?php echo (!empty($MSGS['errors'])) ? gt_error_alert_box($MSGS['errors']) : '' ?>
<?php echo (!empty($MSGS['success'])) ? gt_success_alert_box($MSGS['success']) : '' ?>

<div class="gt_full_page">

    <form action="" method="post" id="gt_course_quals_form">
        <input type="hidden" name="sesskey" value="<?php echo sesskey() ?>" />

        <div class="gt_form_panel">

            <div class="gt_form_panel_heading"><?php echo $string['managemodulelinking'] ?></div>

            <div class="gt_form_panel_body">

                <p class="gt_c">
                    <a class="gt_btn" href="<?php echo $CFG->wwwroot ?>/blocks/gradetracker/config.php?view=assessments&section=modules&page=edit"><?php echo $string['modlinking:new'] ?></a>
                </p>

                <div style='width:100%;overflow-x:auto;'>

                    <table id="gt_mod_linking" class="gt_config">

                        <tr>
                            <th><?php echo $string['modlinking:mod'] ?></th>
                            <th><?php echo $string['modlinking:modtable'] ?></th>
                            <th><?php echo $string['modlinking:parttable'] ?></th>
                            <th><?php echo $string['modlinking:partmoddbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:coursedbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:startdatedbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:duedatedbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:instancetitledbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:parttitledbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissiontable'] ?></th>
                            <th><?php echo $string['modlinking:submissionpartdbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissionmodinstancedbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissionuserdbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissiondatedbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissionstatusdbcolumn'] ?></th>
                            <th><?php echo $string['modlinking:submissionstatusexpectedvalue'] ?></th>
                            <th><?php echo $string['modlinking:auto'] ?></th>
                            <th><?php echo $string['enabled'] ?></th>
                            <th><?php echo get_string('edit') ?></th>
                            <th><?php echo get_string('delete') ?></th>
                        </tr>

                        <?php if ($mods): ?>

                            <?php foreach($mods as $mod): ?>

                                <tr>
                                    <td><?php echo \gt_html($mod->getModName()) ?></td>
                                    <td><?php echo \gt_html($mod->getModTable()) ?></td>
                                    <td><?php echo \gt_html($mod->getPartTable()) ?></td>
                                    <td><?php echo \gt_html($mod->getPartModCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getModCourseCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getModStartCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getModDueCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getModTitleCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getPartTitleCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubTable()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubPartCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubModCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubUserCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubDateCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubStatusCol()) ?></td>
                                    <td><?php echo \gt_html($mod->getSubStatusVal()) ?></td>
                                    <td><img src="<?php echo $CFG->wwwroot ?>/blocks/gradetracker/pix/<?php echo ( ($mod->hasAutoUpdates()) ? 'on.png' : 'off.png' ) ?>" alt="<?php echo $mod->getAuto() ?>" /></td>
                                    <td><img src="<?php echo $CFG->wwwroot ?>/blocks/gradetracker/pix/<?php echo ( ($mod->isEnabled()) ? 'on.png' : 'off.png' ) ?>" alt="<?php echo $mod->getAuto() ?>" /></td>
                                    <td><a href="<?php echo $CFG->wwwroot ?>/blocks/gradetracker/config.php?view=assessments&section=modules&page=edit&id=<?php echo $mod->getID() ?>"><img src="<?php echo gt_image_url('i/edit') ?>" alt="<?php echo get_string('edit') ?>" /></a></td>
                                    <td><a href="<?php echo $CFG->wwwroot ?>/blocks/gradetracker/config.php?view=assessments&section=modules&page=delete&id=<?php echo $mod->getID() ?>"><img src="<?php echo gt_image_url('t/delete') ?>" alt="<?php echo get_string('delete') ?>" /></a></td>
                                </tr>

                            <?php endforeach; ?>

                        <?php endif; ?>

                    </table>

                </div>

            </div>

        </div>


    </form>

</div>